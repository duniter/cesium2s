fragment Cert on Cert {
  __typename
  id
  expireOn
  createdOn
  receiver {
    ...LightIdentity
  }
  issuer {
    ...LightIdentity
  }
}

query CertsConnectionByIssuer($address: String!, $first: Int!, $orderBy: [CertOrderBy!]!, $after: String) {
  identityConnection(where: { accountId: { _eq: $address } }) {
    edges {
      node {
        certIssuedAggregate {
          aggregate {
            count
          }
        }
        certIssued_connection(first: $first, after: $after, orderBy: $orderBy) {
          edges {
            node {
              ...Cert
              receiver {
                ...LightIdentity
              }
            }
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
    }
  }
}

query CertsConnectionByReceiver($address: String!, $first: Int!, $orderBy: [CertOrderBy!]!, $after: String) {
  identityConnection(where: { accountId: { _eq: $address } }) {
    edges {
      node {
        certReceivedAggregate {
          aggregate {
            count
          }
        }
        certReceived_connection(first: $first, after: $after, orderBy: $orderBy) {
          edges {
            node {
              ...Cert
              issuer {
                ...LightIdentity
              }
            }
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
    }
  }
}
